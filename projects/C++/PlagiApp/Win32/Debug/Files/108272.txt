3
Ac{z();.();;i;==();.();AA;M(,-){iiA;b;bA;[].X(A);[A].X();}(,,-,,,);hh;M(,)h[]hh[]h;S;}
Jc{hh;();}
J(,,,,,){[]=;[]=;O(([])>)c;=;M(,[]){O([][]l)U;O(l)a;([][],,(+)%,+(h)*[][],+(h)*[][],-);a;}}
c{z{z((););.;.((););;;;i;i;i;===((););.;.((););A;AAA;MM(,,-)){i{iiiiAA;bb;b;bAbA;A;[[].].XX(AA);;[AA].].X.X(();;}(}(,(,,,-,-,,,,,,););h;hhh;MM(,,)h)h[[]h]hhhh[[]hh;S;S;
c{h{hhhh;h;(();
(,,,,,,,,,,,,,)){[{[]]=;=;[;[]]=;=;O;O(O(((([[]))>)>)c)c;;=;=;MM(,(,[[])){O{O(O([[][[]ll)UU;OO(ll)a)a;a;(;([[][[],],,,,((+))%,,+(+(h(h))*[[][[],,+(+(h(h))*[[][[],,-)-););a;a;a;}
